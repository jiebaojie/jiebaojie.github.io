---
layout: post
notes: true
subtitle: Solr in Action
comments: false
author: "Trey Grainger, Timothy Potter(范炜 等译)"
date: 2017-10-29 00:00:00

---

![](/img/notes/search/solrInAction/solr_in_action.jpg)

*   目录
{:toc }

# 第1部分 初识Solr

Solr的两个最重要的功能：索引数据和执行查询。

## 1. Solr入门

本章要点：

*	搜索引擎处理的数据所具备的特征
*	常见搜索引擎用例
*	Solr核心组件
*	选择Solr的理由
*	功能概述

Solr是可扩展的、开箱即用的企业级搜索引擎，用来搜索大规模文本数据并根据相关度排序结果。

*	可扩展——Solr通过集群中多台服务器的分布式运行实例扩展
*	开箱即用——Solr是开源的，易于安装和配置，并提供预先配置好的示例服务器，方便上手
*	为搜索优化——Solr速度很快，以亚秒级速度执行复杂查询，往往只需花费几十毫秒
*	大规模文档——Solr可以用于处理包含百万级文档的索引
*	以文本为中心——Solr针对自然语言文本搜索进行优化，如电子邮件、网页、简历、PDF文档、社交消息（推文和博客）
*	根据相关度对结果排序——Solr根据文档与用户查询的相关程度对文档进行排序，并以此顺序返回结果文档
*	根据相关度对结果排序——Solr根据文档与用户查询的相关度程度对文档进行排序，并以此顺序返回结果文档

### 1.1 为什么需要搜索引擎

#### 1.1.1 管理以文本为中心的数据

类似Solr这样的搜索引擎擅长处理的数据表现为4个主要特征：

1.	以文本为中心
2.	读主导
3.	面向文档
4.	灵活的模式

#### 1.1.2 常见的搜索引擎用例

##### 基础关键词搜索

为了达到出色的用户体验，必须考虑以下几点：

*	必须快速返回相关结果，大多数情况下应该在一秒之内或更短
*	在用户拼错一些查询词时，需要进行拼写纠错
*	自动建议会减少击键次数，特别对移动应用而言
*	识别查询词项的同义词
*	匹配包含查询词项语言形式变化的文档
*	短语处理是必要的，即用户想要匹配整个短语或部分文字
*	必须处理查询中包含的"a"、"an"、"the"等常用词
*	如果用户对排名靠前的搜索结果不满意，必须能继续查看更多结果

根据相关度对文档进行排名是非常重要的，原因如下：

*	现代搜索引擎通常存储大量文档，往往以百万计或数十亿计。若部根据查询相关度对文档进行排名，就会缺乏清晰的导航方式，用户将无法应对搜索结果
*	用户更习惯于使用那些只需要输入几个关键词就能得到结果的搜索引擎，用户没有耐心，希望搜索引擎能达到“不用我说，你懂得”的结果。

第3章会深入介绍文档排名

##### 超越关键词搜索

除了返回匹配的文档之外，还应告诉用户下一步该怎么做。例如，根据文档特征对搜索结果进行分类，方便用户缩小搜索范围。这就是所谓的*分面搜索*，是Solr的强项之一（第8章）

##### 不要将搜索引擎用于......

不适合搜索引擎的用例：

*	返回大量文档
*	深度分析任务
*	SQL复杂关系型数据结构中的关系发现
*	支持文档级别的安全策略

### 1.2 Solr是什么

Solr不是什么

*	Solr不是Google或Bing这样的网络搜索引擎
*	Solr不具备网站搜索引擎优化（SEO）方面的功能

Solr的一些主要功能：

*	基础关键词搜索
*	强大的地理空间查询解决方案
*	用户执行查询后，Solr的分面功能可以对搜索结果进一步细分，显示结果集的文档特征。

#### 1.2.1 信息检索引擎

信息检索（Information Retrieval, IR）是从大规模集合（通常存储在计算机）中查找满足特定信息需求的具有非结构化性质（通常是文本）的资料（通常是文档）的过程。

第3章会介绍倒排索引的原理。

#### 1.2.2 灵活的模式管理

通过schema.xml的XML配置文件，Solr提供了一种简单明了的索引结构定义和字段表示及分析方法。Solr后台使用schema.xml表示所有可能的字段和数据类型，将文档映射为Lucene索引。这样可以节省编程时间，并让索引结果更易于理解和交流。

Solr还对Lucene核心索引功能进行了扩展。Solr增加了复制字段（copy field）和动态字段（dynamic field）。

第5章和第6章将深入介绍schema.xml。

#### 1.2.3 Java Web应用

Solr是一个Java Web应用，可以运行在任何主流Java Servlet引擎中。

#### 1.2.4 一台服务器上的多个索引

Solr支持在单个引擎上运行多个内核。

每个内核可视为一个单独的索引和配置，并且一个Solr实例可以包含多个内核。

Solr支持多核的一个用途是数据分区。

#### 1.2.5 可扩展性（插件）

每个子系统都是由模块化的“管道”构成的，通过插件方式实现新功能。

#### 1.2.6 可伸缩性

Solr提供灵活的缓存管理功能，帮助服务器重用运算量大的数据扩容（第4章介绍）

Solr伸缩行的两个最常见维度：

*	查询吞吐量
*	文档索引量

#### 1.2.7 容错性

第12章和第13章将讨论故障转移场景

Solr拥有先进的、精心设计的架构来满足可伸缩性和容错性