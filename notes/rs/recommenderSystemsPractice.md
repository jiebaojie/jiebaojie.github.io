---
layout: post
notes: true
subtitle: "推荐系统实践"
comments: false
author: "项亮"
date: 2018-01-29 00:00:00

---

![](/img/notes/rs/recommenderSystemsPractice/recommender_systems_practice.jpg)

*   目录
{:toc }

# 第1章 好的推荐系统

## 1.1 什么是推荐系统

推荐系统的任务就是联系用户和信息，一方面帮助用户发现对自己有价值的信息，另一方面让信息能够展现在对它感兴趣的用户面前，从而实现信息消费者和信息生产者的双赢。

推荐系统的基本任务是联系用户和物品，解决信息过载的问题。

从物品的角度出发，推荐系统可以更好地发掘物品的长尾。

推荐算法的本质是通过一定的方式将用户和物品联系起来，而不同的推荐系统利用了不同的方式。如利用好友、用户的历史兴趣记录以及用户的注册信息等。

## 1.2 个性化推荐系统的应用

几乎所有的推荐系统应用都是由前台的展示页面、后台的日志系统以及推荐算法系统3部分构成的。

### 1.2.1 电子商务

亚马逊的个性化推荐列表：

*	**推荐结果的标题、缩略图以及其他内容属性**：告诉用户给它们推荐的是什么
*	**推荐结果的平均分**
*	**推荐理由**

亚马逊的两种推荐方式：

*	一种基于物品的推荐算法（item-based method）：给用户推荐那些和他们之前喜欢的物品相似的物品。
*	按照用户在Facebook的好友关系，给用户推荐他们的好友在亚马逊上喜欢的物品。

亚马逊相关推荐列表：

*	包含购买了这个商品的用户也经常购买的其他商品
*	包含浏览过这个商品的用户经常购买的其他商品

相关推荐列表最重要的应用就是打包销售

### 1.2.2 电影和视频网站

*	Netflix：基于物品的推荐算法，即给用户推荐和他们曾经喜欢的电影相似的电影
*	Youtube：基于物品的推荐算法。
*	Hulu：和Youtube类似

### 1.2.3 个性化音乐网络电台

个性化推荐的成功应用需要两个条件：

*	第一是存在信息过载因为如果用户可以很容易地从所有物品中找到喜欢的物品，就不需要个性化推荐了。
*	第二是用户大部分没有特别明确的需求，因为用户如果有明确的需求，可以直接通过搜索引擎找到感兴趣的物品。

思路：不允许用户点歌，而是给用户几种反馈方式——喜欢、不喜欢和跳过。经过用户一定时间的反馈，电台就可以从用户的历史行为中习得用户的兴趣模型，从而使用户的播放列表越来越符合用户对歌曲的兴趣。算法主要基于内容。

音乐推荐的特点：

*	**物品空间大**：物品数很多
*	**消费每首歌的代价很小**
*	**物品种类丰富**
*	**听一首歌耗时很少**
*	**物品重用率很高**
*	**用户充满激情**
*	**上下文相关**：包括用户当时的心情和所处情境
*	**次序很重要**
*	**很多播放列表资源**
*	**不需要用户全神贯注**
*	**高度社会化**：比如我们会和好友分享自己喜欢的音乐

### 1.2.4 社交网络

社交网络中的个性化推荐技术主要应用在3个方面：

*	利用用户的社交网络信息对用户进行个性化的物品推荐
*	信息流的会话推荐
*	给用户推荐好友

Facebook最宝贵的数组有两个，一个是用户之间的社交网络关系，另一个是用户的偏好信息。

### 1.2.5 个性化阅读

个性化阅读同样符合前面提出的需要个性化推荐的两个因素：

*	首先，互联网上的文章非常多，用户面临信息过载的问题；
*	其次，用户很多时候并没有必须看某篇具体文章的需求，他们只是想通过阅读特定领域的文章了解这些领域的动态。

个性化阅读工具：

*	Google Reader：允许用户关注自己感兴趣的人，然后看到所关注用户分享的文章
*	Zite：收集用户对文章的偏好信息
*	Digg：首先根据用户的Digg历史计算用户之间的兴趣相似度，然后给用户推荐和他兴趣相似的用户喜欢的文章。

### 1.2.6 基于位置的服务

基于位置的服务往往和社交网络结合在一起。

### 1.2.7 个性化邮件

Tapestry：通过分析用户阅读邮件的历史行为和习惯对新邮件进行重新排序，从而提高用户的工作效率。

### 1.2.8 个性化广告

个性化广告投放技术主要分为3种：

*	上下文广告：通过分析用户正在浏览的网页内容，投放和网页内容相关的广告。如：Adsense
*	搜索广告：通过分析用户在当前会话中的搜索记录，判断用户的搜索目的，投放和用户目的相关的广告。
*	个性化展示广告：根据用户的兴趣，对不同用户投放不同的展示广告。

## 1.3 推荐系统评测

一个好的推荐系统是能够令三方共赢的系统：用户、物品提供者和提供推荐系统的网站。

好的推荐系统不仅仅能够准确预测用户的行为，而且能够扩展用户的视野，帮助用户发现那些他们可能会感兴趣，但却不那么容易发现的东西。同时，推荐系统还要能够帮助商家将那些被埋没在长尾中的好商品介绍给可能会对它们感兴趣的用户。

指标：

*	精确度
*	覆盖度
*	新颖度
*	惊喜度
*	信任度
*	透明度

### 1.3.1 推荐系统实验方法

#### 1. 离线实验

几个步骤：

1.	通过日志系统获得用户行为数据，并按照一定格式生成一个标准的数据集；
2.	将数据集按照一定的规则分成训练集和测试集
3.	在训练集上训练用户兴趣模型，在测试集上进行预测
4.	通过事先定义的离线指标评测算法在测试集上的预测结果

优点：

*	不需要有对实际系统的控制权
*	不需要用户参与实验
*	速度快，可以测试大量算法

缺点：

*	无法计算商业上关心的指标
*	离线实验的指标和商业指标存在差距

#### 2. 用户调查

用户调查需要有一些真实用户，然他们在需要测试的推荐系统上完成一些任务。在他们完成任务时，我们需要观察和记录他们的行为，并让他们回答一些问题。最后，我们需要通过分析他们的行为和答案了解测试系统的性能。

优点：可以获得很多体现用户主观感受的指标，相对在线实验风险很低，出现错误后很容易弥补。

缺点：

*	招募测试用户代价较大，很难组织大规模的测试用户，因此会使测试结果的统计意义不足。
*	在很多时候设计双盲实验非常困难，而且用户在测试环境下的行为和真实环境下的行为可能有所不同，因而在测试环境下收集的测试指标可能在真实环境下无法重现。 

#### 3. 在线实验

在完成离线实验和必要的用户调查后，可以将推荐系统上线做AB测试，将它和旧的算法进行比较。

优点：可以公平获得不同算法实际在线时的性能指标，包括商业上关注的指标。

缺点：周期比较长，必须进行长期的实验才能得到可靠的结果。

一般来说，一个新的推荐算法最终上线，需要完成上面所说的3个实验：

*	首先，需要通过离线实验证明它在很多离线指标上优于现有的算法。
*	然后，需要通过用户调查确定它的用户满意度不低于现有的算法。
*	最后，通过在线的AB测试确定它在我们关心的指标上优于现有的算法。

### 1.3.2 评测指标

#### 1. 用户满意度

*	问卷调查
*	通过一些对用户行为的统计得到（点击率、用户停留时间、转化率等）

#### 2. 预测准确度

*	评分预测
*	TopN推荐：准确率(precision)/召回率(recall)
*	关于评分预测和TopN推荐的讨论：评分预测一直是推荐系统研究的热点，TopN推荐更符合实际的应用需求。

#### 3. 覆盖率

覆盖率(coverage)描述一个推荐系统对物品长尾的发掘能力。

覆盖率最简单的定义：为推荐系统能够推荐出来的物品占总物品集合的比例。

考虑到流行度分布：如果所有的物品都出现在推荐列表中，且出现的次数差不多，那么推荐系统发掘长尾的能力就很好。

*	信息熵
*	基尼系数（Gini Index）

社会学领域有一个著名的马太效应，即所谓强者更强，弱者更弱的效应。如果一个系统会增大热门物品和非热门物品的流行度差距，让热门的物品更加热门，不热门的物品更加不热门，那么这个系统就有马太效应。

推荐系统的初衷是希望消除马太效应，使得各种物品能被展示给它们感兴趣的某一类人群。很多研究表明现在主流的推荐算法（比如协同过滤算法）是具有马太效应的。评测推荐系统是否具有马太效应的简单办法就是使用基尼系数。如果G1是从初始用户行为中计算出的物品流行度的基尼系数，G2是从推荐列表中计算出的物品流行度的基尼系数，那么如果G2>G1，就说明推荐算法具有马太效应。

#### 4. 多样性

如果推荐列表比较多样，覆盖了用户绝大多数的兴趣点，那么就会增加用户找到感兴趣物品的概率。

多样性描述了推荐列表中物品两两之间的不相似性。

#### 5. 新颖性

新颖的推荐是指给用户推荐那些他们以前没有听说过的物品。在一个网站中实现新颖性的最简单办法是，把那些用户之前在网站中对其有过行为的物品从推荐列表中过滤掉。

#### 6. 惊喜度

令用户惊喜的推荐结果是和用户历史上喜欢的物品不相似，但用户却觉得满意的推荐。

提高推荐惊喜度需要提高推荐结果的用户满意度，同时降低推荐结果和用户历史兴趣的相似度。

#### 7. 信任度

度量推荐系统的信任度只能通过问卷调查的方式，询问用户是否信任推荐系统的推荐结果。

提高推荐系统的信任度主要有两种方法：

*	首先需要增加推荐系统的透明度(transparency)，而增加推荐系统透明度的主要办法是提供推荐解释。
*	其次是考虑用户的社交网络信息，利用用户的好友信息给用户做推荐，并且用好友进行推荐解释。

#### 8. 实时性

推荐系统的实时性包括两个方面：

*	首先，推荐系统需要实时地更新推荐列表来满足新的行为变化。
*	第二个方面是推荐系统需要能够将新加入系统的物品推荐给用户。者主要考验了推荐系统处理物品冷启动的能力。

##### 9. 健壮性

健壮性（即robust，鲁棒性）指标衡量了一个推荐系统抗击作弊的能力。

算法健壮性的评测主要利用模拟攻击：

*	首先，给定一个数据集和一个算法，可以用这个算法给这个数据集中的用户生成推荐列表。
*	然后，用常用的攻击方法向数据集中注入噪声数据，然后利用算法在植入噪声后的数据集上再次给用户生成推荐列表。
*	最后，通过比较攻击前后推荐列表的相似度评测算法的健壮性。

如果攻击后的推荐列表相对于攻击前没有发生大的变化，就说明算法比较健壮。

在实际系统中，提高系统的健壮性，除了选择健壮性高的算法，还有：

*	设计推荐系统时尽量使用代价比较高的用户行为。
*	在使用数据前，进行攻击检测，从而对数据进行清理。

#### 10. 商业目标

最本质的商业目标就是平均一个用户给公司带来的盈利，但计算一次需要比较大的代价。

#### 11. 总结

对于可以离线优化的指标，是应该在给定覆盖率、多样性、新颖性等限制条件下，尽量优化预测准确度。

### 1.3.3 评测维度

评测维度分为如下3种：

*	**用户维度**：主要包括用户的人口统计学信息、活跃度以及是不是新用户等
*	**物品维度**：包括物品的属性信息、流行度、平均分以及是不是新加入的物品等
*	**时间维度**：包括季节，是工作日还是周末，是白天还是晚上等